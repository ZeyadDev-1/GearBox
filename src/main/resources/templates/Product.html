<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" th:href="@{/css/product.css}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <th:block th:include="navbar"></th:block>
    <div class="containers">
        <img th:src="@{'/product/' + ${product.id} + '/image'}"
             th:alt="${product.name} ?: 'Unknown Product'" 
             class="left-column-img"
             onerror="this.src='/images/placeholder.jpg'">
        <div class="right-column">
            <div class="product-description">
				<div class="product-header">
				    
				    <h6>
				        <a th:text="#{product.listed}">Listed</a>: 
				        <i th:text="${product.releaseDate != null} ? ${#temporals.format(product.releaseDate, 'dd/MM/yyyy')} : 'Unknown Date'"></i>
				    </h6>
				</div>
                <h1 th:text="${product.name} ?: 'Unknown Product'"></h1>
                <i th:text="${product.brand} ?: 'Unknown Brand'"></i>
                <p><strong th:text="#{product.product_description}">PRODUCT DESCRIPTION:</strong></p>
                <p th:text="${product.description} ?: 'No description available'"></p>
            </div>
            <div class="product-price">
                <span th:text="'$' + (${product.price != null} ? ${product.price} : '0.00')"></span>
                <form th:action="@{/cart/add}" method="post">
                    <input type="hidden" name="productId" th:value="${product.id}">
                    <button type="submit" class="cart-btn"
                            th:disabled="${product.stockQuantity <= 0 or !product.productAvailable}">
                        <span th:if="${product.stockQuantity > 0 and product.productAvailable}" th:text="#{product.add_to_cart}">Add to Cart</span>
                        <span th:unless="${product.stockQuantity > 0 and product.productAvailable}" th:text="#{product.out_of_stock}">Out of Stock</span>
                    </button>
                </form>
                <h6 th:text="#{product.stock_available} + ': ' + (${product.stockQuantity} ?: '0')">Stock Available: <i th:text="${product.stockQuantity} ?: '0'"></i></h6>
            </div>
            <div class="update-button" th:if="${isAdmin}">
                <a th:href="@{'/product/update/' + ${product.id}}" class="btn btn-primary" th:text="#{product.update}">Update</a>
                <form th:action="@{'/product/delete/' + ${product.id}}" method="post" class="d-inline">
                    <button type="submit" class="btn btn-danger" th:text="#{product.delete}">Delete</button>
                </form>
            </div>
        </div>
    </div>
    <div th:if="${message}" class="alert alert-success" th:text="${message}"></div>
    <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>
</body>
</html>