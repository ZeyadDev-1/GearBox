<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" th:href="@{/css/checkout.css}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <th:block th:include="navbar"></th:block>
    <div class="checkout-container">
        <h2 th:text="#{checkout.title}">Checkout</h2>
        <div th:if="${#lists.isEmpty(cartItems)}">
            <p th:text="#{cart.empty}">Your cart is empty</p>
        </div>
        <div th:unless="${#lists.isEmpty(cartItems)}">
            <div class="checkout-items">
				<div class="checkout-item" th:each="item : ${cartItems}">
				    <img th:src="@{'/product/' + ${item.product.id} + '/image'}" 
				         th:alt="${item.product.name} ?: 'Unknown Product'" 
				         class="cart-item-image"
				         onerror="this.src='/images/placeholder.jpg'">
				    <div class="item-details">
				    <b><p th:text="${item.product.name} ?: 'Unknown Product'"></p></b>
	     <p><span th:text="#{checkout.quantity}"></span>: <span th:text="${item.quantity}"></span></p>
	     <p><span th:text="#{checkout.price}"></span>: $<span th:text="${item.totalPrice != null} ? ${item.totalPrice} : '0.00'"></span></p>
				    </div>
				</div>
            <div class="total">
		<h5><span th:text="#{checkout.total}">Total</span>: $<span th:text="${totalPrice != null} ? ${totalPrice} : '0.00'"></span></h5>

            </div>
            <form th:action="@{/checkout}" method="post">
        <button type="submit" class="btn btn-primary" th:text="#{checkout.confirm}">Confirm Purchase</button>
                <a href="/cart" class="btn btn-secondary" th:text="#{checkout.cancel}">Cancel</a>
            </form>
        </div>
        <div th:if="${message}" class="alert alert-success" th:text="${message}"></div>
        <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>
    </div>
</body>
</html>